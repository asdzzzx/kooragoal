# Kooragoal Football Data Platform

منصة متكاملة لجمع بيانات كرة القدم من واجهة API-FOOTBALL v3 وتخزينها في قاعدة بيانات محلية مع لوحة تحكم إدارية متقدمة تعمل بالكامل على استضافة CPanel بدون الحاجة إلى Cron Job فعلي.

## المزايا الرئيسية
- جدولة ذكية داخلية تعتمد على جداول `system_updates` ويتم تشغيلها تلقائيًا مع كل طلب للوحة التحكم.
- دعم تحديث المباريات اليومية، المباريات الجارية، الإحصائيات، الأحداث، التشكيلات، الترتيب، الهدافين، الفرق واللاعبين وفق الجداول الزمنية المطلوبة.
- لوحة تحكم مبنية بـ Bootstrap 5 و jQuery توفر إحصائيات لحظية وإدارة للمستخدمين والسجلات.
- نظام حماية متعدد الطبقات يشمل الجلسات الآمنة، CSRF، محاولات تسجيل الدخول، وسجلات نشاط تفصيلية.

## المتطلبات
- PHP 8.2 أو أعلى مع تفعيل PDO و cURL
- MySQL 8 أو أعلى
- Apache مع دعم mod_rewrite

## التثبيت
1. استورد ملف قاعدة البيانات `football_db.sql` إلى قاعدة البيانات الخاصة بك.
2. حدّث بيانات الاتصال بقاعدة البيانات ومفتاح الـ API في `config/config.php` حسب بيئتك.
3. ارفع ملفات المشروع كاملة إلى الاستضافة بحيث يكون ملف `.htaccess` في الجذر ويشير إلى مجلد `public/`.
4. أنشئ مستخدمًا إداريًا أوليًا عن طريق إدخال سجل في جدول `admins` مع كلمة مرور مشفرة باستخدام `password_hash`.

## كيف يعمل المجدول الذكي؟
- يتم تحميل `Scheduler` في كل زيارة للوحة التحكم أو صفحات الواجهة العامة ويقوم بمراجعة جدول `system_updates`.
- عند استحقاق أي مهمة يتم استدعاء الكلاس المناسب داخل `UpdateManager` لتنفيذ عملية السحب والتحديث.
- تُسجّل جميع النتائج في جدول `system_updates` وفي ملف السجلات `logs/app.log` بالإضافة إلى جدول `logs`.

## لوحة التحكم
- `/admin/login.php` لتسجيل الدخول الآمن.
- `/admin/index.php` لعرض ملخص البيانات والمهام المجدولة.
- `/admin/fixtures.php` لإدارة المباريات وسحب البيانات مباشرة.
- `/admin/live_fixtures.php` لمراقبة النتائج المباشرة.
- `/admin/leagues.php` و`/admin/teams.php` لمراجعة بيانات الدوريات والفرق.
- `/admin/standings.php` و`/admin/scorers.php` و`/admin/statistics.php` لتحليل البيانات الأساسية.
- `/admin/match_details.php` مع صفحات فرعية للأحداث والإحصائيات التفصيلية.
- `/admin/updates.php` لتشغيل عمليات التحديث اليدوية ومتابعة سجل التنفيذ.
- `/admin/users.php` لإدارة المسؤولين، و`/admin/profile.php` لتغيير كلمة المرور.
- `/admin/logs.php` للاطلاع على السجلات، و`/admin/settings.php` لمراجعة إعدادات الاتصال.

## الروابط العامة
- `/league/{id}` لعرض مباريات الدوري.
- `/match/{id}` لعرض تفاصيل المباراة.
- `/events/{fixture_id}` و`/stats/{fixture_id}` لعرض الأحداث والإحصائيات.
- `/standings/{league_id}` و`/scorers/{league_id}` لعرض الترتيب والهدافين.
- `/today` لعرض مباريات اليوم، و`/live` لعرض المباريات الجارية.

## الأمن
- استخدام PDO مع استعلامات محضرة لجميع العمليات.
- حماية CSRF في جميع النماذج.
- قفل تلقائي للحساب بعد عدد محاولات فاشلة.
- تسجيل تلقائي لكل العمليات في جدول `logs` وملف سجل منفصل.
